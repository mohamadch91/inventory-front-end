"use strict";(self.webpackChunkinventory=self.webpackChunkinventory||[]).push([[2896],{92896:function(e,n,t){t.r(n),t.d(n,{default:function(){return G}});var s=t(72791),a=t(74165),i=t(15861),r=t(29439),l="ChartDropDown_drop__3zt0I",c=t(12902),d=t(80184),o=function(e){return console.log(e),(0,d.jsx)("div",{className:l,children:(0,d.jsxs)("select",{onChange:e.onChange,children:[(0,d.jsx)(c.W,{children:function(n,t){t.i18n;return(0,d.jsx)("option",{i18n:!0,value:"",selected:!0,children:n("".concat(e.text))})}}),e.options.map((function(e,n){return(0,d.jsx)("option",{value:e.id,children:e.op},n)}))]})})},u="Facilities_facilities__joa8-",h="Card_card__Bhi4l",x=function(e){return(0,d.jsx)("div",{className:h,children:e.children})},p=t(65218),j=(t(59909),t(31457)),m=t(30606),v=t(10140),f=t(91933),g=function(){var e=(0,s.useState)([]),n=(0,r.Z)(e,2),t=n[0],l=n[1],c=(0,s.useState)(),h=(0,r.Z)(c,2),p=h[0],g=h[1],b=(0,f.useQuery)(["charts-facilities"],(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.Z.getAllFacilities();case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),{refetchOnMount:!0}),N=b.data,y=b.isLoading;if(!b.isFetched)return(0,d.jsx)("div",{className:"spinner-wrapper",style:{position:"relative"},children:(0,d.jsx)("div",{className:"donut"})});if(!y&&0===t.length){var w=[];N.map((function(e,n){w.push({op:e.name,id:n,facility:e})})),l(w),console.log(t)}return(0,d.jsx)("div",{className:u,children:(0,d.jsxs)(x,{className:"w-50",children:[(0,d.jsxs)("h3",{children:["\ud83c\udfe2 ",(0,d.jsx)(m.c,{children:"Facilities"})," "]}),(0,d.jsx)(o,{onChange:function(e){e.preventDefault(),t.map((function(n){if(n.id===+e.target.value){var t=+n.facility.defined;g({defined:t.toFixed(2),subFacilities:n.facility.sub_fac,lower:n.facility.lower})}}))},options:t,text:"Select facility"}),(0,d.jsx)(j.Z,{id:"gauge-chart6",animate:!0,nrOfLevels:15,percent:p?p.defined:0,needleColor:"#345243",colors:["#EA4228","#F5CD19","#5BE12C"],textColor:"#000000",animDelay:100}),p&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{children:p.subFacilities}),(0,d.jsxs)("p",{children:[" ",(0,d.jsx)(m.c,{children:"Sub Facilities defined"})," "]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{children:p.lower}),(0,d.jsxs)("p",{children:[" ",(0,d.jsx)(m.c,{children:"Can be defined"})," "]}),(0,d.jsx)("br",{})]})]})]})})};function b(){return N.apply(this,arguments)}function N(){return(N=(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Z.getAllDashboardItems();case 3:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("Error fetching data from back-end "+e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function y(){return w.apply(this,arguments)}function w(){return(w=(0,i.Z)((0,a.Z)().mark((function e(){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Z.getAllTablesData();case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),403===(null===(t=e.t0.response)||void 0===t?void 0:t.status)&&(window.location.href="/error-pages/error-403"),401===(null===t||void 0===t?void 0:t.status)&&(localStorage.removeItem("user"),localStorage.removeItem("country"),window.location.href="/login");case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var _=t(1413);function Z(e,n){return"SEND"===n.type?{data:null,error:null,status:"pending"}:"SUCCESS"===n.type?{data:n.responseData,error:null,status:"completed"}:"ERROR"===n.type?{data:null,error:n.errorMessage,status:"completed"}:e}var k=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=(0,s.useReducer)(Z,{status:n?"pending":null,data:null,error:null}),l=(0,r.Z)(t,2),c=l[0],d=l[1],o=(0,s.useCallback)(function(){var n=(0,i.Z)((0,a.Z)().mark((function n(t){var s;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d({type:"SEND"}),n.prev=1,n.next=4,e(t);case 4:s=n.sent,d({type:"SUCCESS",responseData:s}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),d({type:"ERROR",errorMessage:n.t0.message||"Something went wrong!"});case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}(),[e]);return(0,_.Z)({sendRequest:o},c)},C={item:"ItemCard_item__XSGC1"},S=function(){var e=(0,s.useState)([]),n=(0,r.Z)(e,2),t=n[0],a=n[1],i=(0,s.useState)([]),l=(0,r.Z)(i,2),c=l[0],u=l[1],h=(0,s.useState)(),v=(0,r.Z)(h,2),f=v[0],g=v[1],N=k(b),y=N.sendRequest,w=N.status,_=N.data,Z=N.error;if((0,s.useEffect)((function(){y()}),[]),"pending"===w)return(0,d.jsx)("div",{className:"spinner-wrapper",style:{position:"relative"},children:(0,d.jsx)("div",{className:"donut"})});if(Z)return p.ZP.error((0,d.jsx)(m.c,{children:"There was a problem loading data"})),(0,d.jsx)("p",{children:Z});if("completed"===w&&0===t.length){var S=[];console.log(_),null===_||void 0===_||_.map((function(e,n){S.push({op:e.item_class,id:n})})),a(S),S=[]}return(0,d.jsx)("div",{className:null===C||void 0===C?void 0:C.item,children:(0,d.jsxs)(x,{children:[(0,d.jsxs)("h3",{children:["\ud83c\udfe2 ",(0,d.jsx)(m.c,{children:"Items"})," "]}),(0,d.jsx)(o,{onChange:function(e){e.preventDefault();var n=[],t=e.target.value;null===_||void 0===_||_.map((function(e,s){s===+t&&e.items.map((function(e,t){n.push({id:t,classId:s,op:e.item_type,working:e.working,notWorking:e.not_working,totalItems:e.total_items})}))})),u(n)},options:t,text:"Select item Class"}),(0,d.jsx)(o,{onChange:function(e){var n=e.target.value;null===c||void 0===c||c.map((function(e){e.id===+n&&g({notWorking:e.notWorking,working:e.working.toFixed(2),totalItems:e.totalItems})}))},options:c,text:"Select items Category"}),(0,d.jsx)(j.Z,{className:"pt-3",id:"gauge-chart6",animate:!0,nrOfLevels:15,percent:f?f.working:0,needleColor:"#345243",colors:["#EA4228","#F5CD19","#5BE12C"],textColor:"#000000",animDelay:100}),f&&(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{children:null===f||void 0===f?void 0:f.totalItems}),(0,d.jsx)("p",{children:(0,d.jsx)(m.c,{children:"Items"})}),(0,d.jsxs)("p",{children:[(0,d.jsx)(m.c,{children:"Working"}),": ",100*(null===f||void 0===f?void 0:f.working),"%"]}),(0,d.jsxs)("p",{children:[(0,d.jsx)(m.c,{children:"Not working"}),": ",null===f||void 0===f?void 0:f.notWorking]})]})]})})},D=t(91523),F=function(e){return(0,d.jsxs)("div",{className:"d-flex mb-3",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("p",{className:"activity-info bg-warning",style:{color:"#000000"},children:[" ","\u26a0"," "]})}),(0,d.jsx)("div",{className:"activity-details",children:(0,d.jsxs)(D.rU,{className:"p-0 btn btn-link btn-fw text-muted ".concat(0===e.count?"pe-none":""," "),style:{fontSize:"16px",textDecorationColor:"#777"},to:"dashboard/warnings-info/"+e.param,children:["(".concat(e.count,")  "),(0,d.jsx)(m.c,{children:e.title}),(0,d.jsxs)("label",{className:"badge badge-danger opacity-".concat(e.badgeOp," "),style:{fontSize:"12px"},children:["  ",(0,d.jsx)(m.c,{children:e.badge})]}),e.maxExtended&&(0,d.jsx)("label",{className:"badge badge-warning  ",style:{fontSize:"12px"},children:(0,d.jsxs)(m.c,{children:[e.maxExtended," days extended"]})})]})})]})},E="Warnings_warnings__73LHj",I=function(){return(0,d.jsxs)("div",{className:"d-flex mb-3",children:[(0,d.jsx)("div",{children:(0,d.jsx)("p",{className:"activity-info bg-info",style:{color:"#000000"},children:"i"})}),(0,d.jsx)("div",{className:"activity-details",children:(0,d.jsx)(D.rU,{className:"p-0 btn btn-link btn-fw text-muted ",style:{fontSize:"16px",textDecorationColor:"#777"},to:"dashboard/maintenanceLog",children:(0,d.jsx)(m.c,{children:"Item Maintenance Logbook"})})})]})},L=[{title:"Maintenance services must be done in",badge:"7 Days"},{title:"Maintenance services must be done in",badge:"3 Days"},{title:"Maintenance services were",badge:"not performed on time"},{title:"Maintenance  services were",badge:"not performed on time"}],O=function(){var e=(0,f.useQuery)(["warnings"],(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.Z.getAllWarningsData();case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),{refetchOnMount:!0}),n=e.data;return e.isLoading||0===n.length?(0,d.jsx)("div",{className:"spinner-wrapper",style:{position:"relative"},children:(0,d.jsx)("div",{className:"donut"})}):(0,d.jsxs)("div",{className:"card-body recent-activity ".concat(E),children:[(0,d.jsx)("h4",{className:"card-title",children:(0,d.jsx)(m.c,{children:"Warnings"})}),(0,d.jsx)("p",{className:"card-description",children:(0,d.jsx)(m.c,{children:"Warnings that need to be taken care of"})}),n&&(0,d.jsxs)("div",{className:"activities",children:[(0,d.jsx)(F,{title:L[0].title,text:L[0].text,badge:L[0].badge,count:n.seven_days,badgeOp:50,param:"day=7"}),(0,d.jsx)(F,{title:L[1].title,text:L[1].text,badge:L[1].badge,count:n.three_days,badgeOp:75,param:"day=3"}),(0,d.jsx)(F,{title:L[2].title,text:L[2].text,badge:L[2].badge,count:n.extended.count,maxExtended:n.extended.maxExtended,badgeOp:100,param:"day=extended"}),(0,d.jsx)(I,{})]})]})},W="Dashbord_charts__aHm0k",M="Dashbord_warning__DSWyr",R="DashboardTables_levels__KWMUa",T="DashboardTables_sub-facilities__YkEFi",A=t(29913),U=function(e){var n=e.updatedOn.split("T")[0].replace(/-/g," / ");return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[" ",e.num," "]},"E"),(0,d.jsx)("td",{className:"py-1",children:e.name},"F"),(0,d.jsx)("td",{children:(0,d.jsxs)("label",{className:"badge badge-info",children:[" ",e.level," "]})},"G"),(0,d.jsx)("td",{className:"py-1",children:" ".concat(e.levelName)},"Z"),(0,d.jsx)("td",{children:(0,d.jsx)(A.Z,{variant:e.variant,now:e.registered})},"H"),(0,d.jsxs)("td",{children:[" ",n," "]},"J")]})},z=function(e){return(0,d.jsxs)("div",{className:"py-2 px-2",children:[(0,d.jsxs)("h4",{className:"card-title",children:[" ",(0,d.jsx)(m.c,{children:"Sub Facilities"})]}),(0,d.jsx)("p",{className:"card-description",children:(0,d.jsx)(m.c,{children:"list of all sub facilities "})}),(0,d.jsx)("div",{className:"table-responsive",children:(0,d.jsxs)("table",{className:"table table-striped",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Code"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Facility Name"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Levels"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Level Name"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Sub facilities registered"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Last Update"})})]})}),(0,d.jsx)("tbody",{children:function(){for(var n=[],t=0;t<e.data.length;t++){var s="",a=100*e.data[t].defined;s=a<20?"danger":a<50?"warning":a<80?"info":"success",n.push((0,d.jsx)(U,{num:e.data[t].code,name:e.data[t].name,level:e.data[t].level_id,levelName:e.data[t].level_name,registered:100*+e.data[t].defined,updatedOn:e.data[t].update,variant:s},t+1))}return n}()})]})})]})},B=function(e){return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:[(0,d.jsxs)("label",{className:"badge badge-info",children:[" ",e.level," "]})," "]},"A"),(0,d.jsx)("td",{children:e.levelName},"B"),(0,d.jsx)("td",{children:e.facilitiesNum},"C"),(0,d.jsx)("td",{children:e.subFacilitiesNum},"D"),(0,d.jsx)("td",{children:e.defSubFacilitiesNum},"E")]})},q=function(e){return(0,d.jsxs)("div",{className:"px-2 py-5",children:[(0,d.jsxs)("h4",{className:"card-title",children:[" \ud83c\udfe2 ",(0,d.jsx)(m.c,{children:"Facilities"})]}),(0,d.jsxs)("p",{className:"card-description",children:[" ",(0,d.jsx)(m.c,{children:"Facilities owned separated by levels"})]}),(0,d.jsx)("div",{className:"table-responsive",children:(0,d.jsxs)("table",{className:"table table-striped",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Levels"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Level Name"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Total number of facilities"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Total number of sub-facilities"})}),(0,d.jsx)("th",{children:(0,d.jsx)(m.c,{children:"Number of Defined sub-level facilities"})})]})}),(0,d.jsx)("tbody",{children:e.data.map((function(e,n){return(0,d.jsx)(B,{level:e.level_id,levelName:e.level_name,facilitiesNum:e.total,subFacilitiesNum:e.sub,defSubFacilitiesNum:e.def},n)}))})]})})]})},H=function(){var e=k(y),n=e.sendRequest,t=e.status,a=e.data,i=e.error,l=(0,s.useState)(!1),c=(0,r.Z)(l,2),o=c[0],u=c[1];return(0,s.useEffect)((function(){n()}),[]),"pending"===t?(0,d.jsx)("div",{className:"spinner-wrapper",style:{position:"relative"},children:(0,d.jsx)("div",{className:"donut"})}):i?(p.ZP.error("There was a problem loading data"),(0,d.jsx)("p",{children:i})):("completed"!==t||o||u(!0),(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)("section",{className:R,children:o&&(0,d.jsx)(q,{data:a.level_table})}),(0,d.jsx)("section",{className:T,children:o&&(0,d.jsx)(z,{data:a.facility_table})})]}))},G=function(){return(0,d.jsxs)("main",{children:[(0,d.jsxs)("section",{className:W,children:[(0,d.jsx)(S,{}),(0,d.jsx)(g,{})]}),(0,d.jsx)("span",{id:"warnings"}),(0,d.jsx)("section",{className:M,children:(0,d.jsx)(O,{})}),(0,d.jsx)(H,{})]})}}}]);
//# sourceMappingURL=2896.afa17eec.chunk.js.map